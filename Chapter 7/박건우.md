# 7장 객체 분해

```
변경을 관리하는 기본적인 전략은 
함께 변경되는 부분을 하나의 구현단위로 묶고,
퍼블릭 인터페이스를 통해서만 접근하도록 만드는 것이다.
```
## 추상화와 분해

- 추상화 : 불필요한 정보를 제거하고, 현재 문제 해결에 필요한 핵심만 남기는 작업
- 분해 : 큰 문제를 해결 가능한 작은 문제로 나누는 작업

복잡한 문제를 해결하기 위해 추상화와 분해를 같이 사용한다

### 시스템을 분해하는 방법

1. 프로시저 추상화를 중심으로 할지 (기능 분해)
2. 데이터 추상화를 중심으로 할지

객체지향?
- 데이터 추상화와 프로시저 추상화가 공존
- 기능을 구현하기 위해 시스템을 협력가능한 객체로 분해
- 데이터를 중심으로 프로시저를 추상화 (추상메서드, 인터페이스)

---

# 흐름

## 1. 기능 분해

- 최상위 기능을 정의하고, 최상위 기능을 하위 기능으로 분해(하향식 접근법)
- main
  - getTaxRate
    - print..
    - return..
  - calculatePayFor
    - index...
    - basePay...
    - return...
  - describeResult
    - return...

### 기능 분해의 문제점

1. 시스템은 하나의 메인 함수로 구성되어 있지 않다.

    >새로운 기능이 추가될수록, 시스템은 동등한 수준의 함수의 집합에 가까워진다

2. 메인 함수의 빈번한 재설계
   
    >기능이 추가될수록, main함수의 내부 구현을 수정할 수 밖에 없다. <br>
     기존 코드의 빈번한 수정이 일어나고, 그에 따른 버그 발생 확률이 높아진다

3. 비즈니스 로직과 사용자 인터페이스의 결합
   - 비즈니스 로직과 사용자 인터페이스는 관심사가 다르고, 변경 주기도 다르다
   - 하지만 하향식 접근법은 이 둘이 밀접하게 결합되어 있어 변경을 어렵게한다.
   
4. 성급하게 결정된 실행순서

    - 기능이 추가되거나 변경될 때 마다 함수들의 제어구조가 바뀌게된다
    - 하위함수는 상위함수가 강요하는 문맥에 강하게 결합된다

5. 데이터 변경으로 인한 파급효과
   
    - 데이터의 변경으로 인한 영향이 해당 데이터를 참조하는 모든 함수로 퍼져나간다
    - 예상치 못하는 곳에서도 영향을 받아, 버그가 발생된다.

## 2. 모듈

- 모듈이 감춰야하는 두가지
  - 복잡성 : 외부에 모듈을 추상화 할 수 있는 간단한 인터페이스만 제공하자
  - 변경가능성 : 자주 변경되는 부분을 상대적으로 덜 변경되는 인터페이스 뒤로 숨기자

- 모듈의 장점
  - 모듈 내부의 변수가 변경되더라도, 모듈 내부에만 영향을 미친다
  - 비즈니스 로직과 사용자 인터페이스를 분리
  - 네임스페이스 오염 방지

- 아직 부족한 점 
  - 인스턴스의 개념을 제공하지 않는다.
  - 개별 직원을 독립적인 단위로 나눌 수 있어야한다

## 3. 추상 데이터 타입(구조체)

- 직원에 관한 데이터를 employee로 추상화 (기본급, 정규직or비정규직, 근무시간)
- 보다 사람의 사고방식과 가까워짐
- 하지만 여전히 데이터와 기능을 분리해서 바라본다.

## 4. 클래스

현재 상황
>하나의 타입처럼 보이는 Employee 안에, 정규 직원과 아르바이트 직원이라는 두개의 타입이 공존한다.

### 추상데이터 타입과 클래스의 차이

- 클래스는 상속과 다형성을 지원하지만 추상 데이터 타입은 그렇지 못함
- 추상 데이터 타입
  - 오퍼레이션을 기준으로 타입을 묶음
  - 내부에 인스턴스 타입을 표현하는 변수가 필요
  - 클라이언트 코드는 해당 타입이 무엇인지 알아야하고, 분기에 따른 처리가 필요 -> 조건문이 생길 수 밖에 없음
- 클래스
  - 타입을 기준으로 오퍼레이션을 묶음
  - 인스턴스 타입을 보다 명시적으로 제시
  - 조건문 제거 가능

클래스 안에 인스턴스의 타입을 표현하는 변수가 있다면, 객체지향을 위반했을 가능성이 높다

인스턴스의 타입은 다형성으로 대체되어야 한다.