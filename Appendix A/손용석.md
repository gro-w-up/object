[](https://happy-coding-day.tistory.com/entry/%EA%B3%84%EC%95%BD%EC%97%90-%EC%9D%98%ED%95%9C-%EC%84%A4%EA%B3%84Contract-By-Design-%EB%8D%94-%EC%9E%98-%ED%99%9C%EC%9A%A9%ED%95%98%EA%B8%B0with-java)[https://happy-coding-day.tistory.com/entry/계약에-의한-설계Contract-By-Design-더-잘-활용하기with-java](https://happy-coding-day.tistory.com/entry/%EA%B3%84%EC%95%BD%EC%97%90-%EC%9D%98%ED%95%9C-%EC%84%A4%EA%B3%84Contract-By-Design-%EB%8D%94-%EC%9E%98-%ED%99%9C%EC%9A%A9%ED%95%98%EA%B8%B0with-java)

책에서 기술하고 있는 `contract`는 C#에서 제공하는 라이브러리이다.

- 협력에 참여하는 각 객체는 계약으로부터 이익을 기대하고 이익을 얻기 위해 의무를 이행한다.
- 협력에 참여하는 각 객체의 이익과 의무는 객체의 인터페이스 상에 문서화된다.

"인터페이스에 대해 프로그래밍하라"는 원칙을 확장한 것.

의도를 드러내는 인터페이스를 만들면 오퍼레이션의 시그니처만으로도 어느 정도까지는 클라이언트와 서버가 협력을 위해 수행해야 하는 제약조건을 ㅁ여시할 수 있다. 계약은 여기서 한 걸음 더 나아간다.

### 사전 조건

메서드가 호출되기 위해 만족돼야 하는 조건. 이것은 메서드의 요구사항을 명시한다. 사전조건이 만족되지 않을 경우 메서드가 실행돼서는 안된다. 사전 조건을 만족시키는 것은 메서드를 실행하는 **클라이언트의 의무**이다.

### 사후조건

메서드가 실행된 후에 클라이언트에게 보장해야 하는 조건. 클라이언트가 사전조건을 만족시켰다면 메서드는 사후조건에 명시된 조건을 만족시켜야 한다. 만약 클라이언트가 사전조건을 만족시켰는데도 사후조건을 만족시키지 못한 경우에는 클라이언트에게 예외를 던져야 한다. 사후조건을 마족시키는 것은 **서버의 의무**다.

- 인스턴스 변수의 상태가 올바른지를 서술하기 위해
- 메서드에 전달된 파라미터의 값이 올바르게 변경됐는지를 서술하기 위해
- 반환값이 올바른지를 서술하기 위해

### 한 메서드 안에서 return 문이 여러 번 나올 경우

모든 return 문마다 결괏값이 올바른지 검증하는 코드를 추가해야 한다. 다행히도 계약에 의한 설계를 지원하는 대부분의 라이브러리는 결괏값에 대한 사후조건을 한 번만 기술할 수 있게 해준다.

### 실행 전과 실행 후의 값을 비교해야 하는 경우

실행 전의 값이 메서드 실행으로 인해 다른 값으로 변경됐을 수 있기 때문에 두 값을 비교하기 어려울 수 있다. 다행히 계약에 의한 설계를 지원하는 대부분의 라이브러리는 실행 전의 값에 접근할 수 있는 간편한 방법을 제공한다.

### 불변식

항상 참이라고 보장되는 **서버의 조건**. 메서드가 실행되는 도중에는 불변식을 만족시키지 못할 수도 있지만 메서드를 실행하기 전이나 종료된 후에 불변식은 항상 참이어야 한다.

- 불변식은 클래스의 모든 인스턴스가 생성된 후에 만족돼야 한다. 이것은 클래스에 정의된 모든 생성자는 불변식을 준수해야 한다는 것을 의미한다.
- 불변식은 클라이언트에 의해 호출 가능한 모든 메서드에 의해 준수돼야 한다. 메서드가 실행되는 중에는 객체의 상태가 불안정한 상태로 빠질 수 있기 때문에 불변식을 만족시킬 필요는 없지만 메서드 실행 전과 메서드 종류 후에는 항상 불변식을 만족하는 상태가 유지돼야 한다.

---

계약 규칙

- 서브타입에 더 강력한 사전조건을 정의할 수 없다.
- 서브타입에 더 완화된 사후조건을 정의할 수 없다.
- 슈퍼타입의 불변식은 서브타입에서도 반드시 유지돼야 한다. 가변성 규칙
- 서브타입의 메서드 파리미터는 반공병성을 가져야 한다.
- 서브타입의 리턴 타입은 공변성을 가져야 한다.
- 서브타입은 슈퍼타입이 발생시키는 예외와 다른 타입의 예외를 발생시켜서는 안된다.